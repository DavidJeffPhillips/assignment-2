Sub HW2_Test()Dim SumVolume As DoubleDim SummaryRow As DoubleDim TickerName As StringFor Each ws In WorksheetsLastRow = ws.Cells(Rows.Count, 1).End(xlUp).RowDim RowCounter As LongRowCounter = 0Dim CloseEnd As DoubleDim OpenBeg As DoubleSumVolume = 0SummaryRow = 2ws.Cells(1, 9).Value = "Ticker"ws.Cells(1, 10).Value = "Total Stock Volume"ws.Cells(1, 11).Value = "Yearly Change"ws.Cells(1, 12).Value = "Percentage Change"For i = 2 To LastRowIf ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1) Then    TickerName = ws.Cells(i, 1).Value    SumVolume = SumVolume + ws.Cells(i, 7)    ws.Cells(SummaryRow, 10) = SumVolume    ws.Cells(SummaryRow, 9) = TickerName    SumVolume = 0    CloseEnd = ws.Cells(i, 6).Value    OpenBeg = ws.Cells(i - RowCounter, 3).Value    RowCounter = 0    If OpenBeg = 0 Then    ws.Cells(SummaryRow, 12).Value = CloseEnd    Else    ws.Cells(SummaryRow, 12).Value = (CloseEnd - OpenBeg) / OpenBeg    End If        ws.Cells(SummaryRow, 12).NumberFormat = "00.00%"    ws.Cells(SummaryRow, 11).Value = CloseEnd - OpenBeg    SummaryRow = SummaryRow + 1Else        SumVolume = SumVolume + ws.Cells(i, 7).Value        RowCounter = RowCounter + 1End IfNext iLastRowSummary = ws.Cells(Rows.Count, 9).End(xlUp).RowDim MaxPercent As DoubleDim MinPercent As DoubleDim MaxVolume As DoubleMaxPercent = Application.WorksheetFunction.Max(Range(ws.Cells(2, 12), ws.Cells(LastRowSummary, 12)))MinPercent = Application.WorksheetFunction.Min(Range(ws.Cells(2, 12), ws.Cells(LastRowSummary, 12)))MaxVolume = Application.WorksheetFunction.Max(Range(ws.Cells(2, 10), ws.Cells(LastRowSummary, 10)))For i = 2 To LastRowSummaryIf ws.Cells(i, 11).Value <= 0 Then    ws.Cells(i, 11).Interior.ColorIndex = 3Else: ws.Cells(i, 11).Interior.ColorIndex = 4End IfIf ws.Cells(i, 12).Value = MaxPercent Thenws.Cells(2, 16).Value = ws.Cells(i, 12).Valuews.Cells(2, 15).Value = ws.Cells(i, 9).ValueEnd IfIf ws.Cells(i, 12).Value = MinPercent Thenws.Cells(3, 16).Value = ws.Cells(i, 12).Valuews.Cells(3, 15).Value = ws.Cells(i, 9).ValueEnd IfIf ws.Cells(i, 10).Value = MaxVolume Thenws.Cells(4, 16).Value = ws.Cells(i, 10).Valuews.Cells(4, 15).Value = ws.Cells(i, 9).ValueEnd IfNext iws.Cells(2, 16).NumberFormat = "00.00%"ws.Cells(3, 16).NumberFormat = "00.00%"ws.Cells(2, 14).Value = "Greatest % Increase"ws.Cells(3, 14).Value = "Greatest % Decrease"ws.Cells(4, 14).Value = "Greatest Total Volume"ws.Cells(1, 15).Value = "Ticker"ws.Cells(1, 16).Value = "Value"Next wsEnd Sub